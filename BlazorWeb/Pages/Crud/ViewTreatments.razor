@page "/viewtreatments"
@inject NavigationManager NavigationManager

<table class="table">
	<thead>
		<tr>
			<td>
				Behandling
			</td>
			<td>
				Beskrivelse
			</td>
		</tr>
	</thead>
	<tbody>
		@foreach (var treatment in treatments)
		{
			<tr>
				<td>
					@treatment.TreatmentName
				</td>
				<td>
					@treatment.Description
				</td>
				<td>
					<a href="/edittreatment/@treatment.TreatmentId">
						<i class="bi bi-pencil-square"></i>
					</a>
				</td>
				<td>
				<td>
					<button @onclick="() => deleteOnClick(treatment.TreatmentId)">
						<i class="bi bi-trash"></i>
					</button>
				</td>
				</td>
			</tr>
		}
	</tbody>

</table>



@code {
	private List<Treatment> treatments = new List<Treatment>();

	protected override void OnInitialized()
	{
		treatments = _treatmentRepo.GetAllTreatments().ToList();
	}

	public async Task deleteOnClick(int treatmentId)
	{
		bool res = await Jsruntime.InvokeAsync<bool>
		("confirm", $"Er du sikker på at du vil slette denne Behandling?");
		if (res)
		{
			await _treatmentRepo.DeleteTreatment(treatmentId);
			toastService.ShowSuccess("Behandlingen blev fjernet");
			NavigationManager.NavigateTo("/viewtreatments");
		}
	}
}